Random Sampling
Training parameters: {'LOG_DIR': '../logs', 'dataset': 'cars', 'sz_embedding': 512, 'sz_batch': 128, 'nb_epochs': 60, 'gpu_id': 0, 'nb_workers': 0, 'model': 'googlenet', 'loss': 'TripletPCA', 'optimizer': 'adamw', 'lr': 0.0001, 'weight_decay': 0.0001, 'lr_decay_step': 20, 'lr_decay_gamma': 0.5, 'alpha': 32, 'mrg': 0.1, 'IPC': None, 'warm': 1, 'bn_freeze': 1, 'l2_norm': 1, 'remark': ''}
Training for 60 epochs.
0it [00:00, ?it/s]Train Epoch: 0 [1/62 (0%)] Loss: 0.056995: : 0it [00:03, ?it/s]Train Epoch: 0 [1/62 (0%)] Loss: 0.056995: : 1it [00:03,  3.30s/it]Train Epoch: 0 [2/62 (2%)] Loss: 0.059708: : 1it [00:04,  4.75s/it]Train Epoch: 0 [2/62 (2%)] Loss: 0.059708: : 2it [00:04,  2.37s/it]Train Epoch: 0 [3/62 (3%)] Loss: 0.059495: : 2it [00:06,  3.05s/it]Train Epoch: 0 [3/62 (3%)] Loss: 0.059495: : 3it [00:06,  2.03s/it]Train Epoch: 0 [4/62 (5%)] Loss: 0.054473: : 3it [00:07,  2.57s/it]Train Epoch: 0 [4/62 (5%)] Loss: 0.054473: : 4it [00:07,  1.93s/it]Train Epoch: 0 [5/62 (6%)] Loss: 0.054755: : 4it [00:08,  2.24s/it]Train Epoch: 0 [5/62 (6%)] Loss: 0.054755: : 5it [00:08,  1.79s/it]Train Epoch: 0 [6/62 (8%)] Loss: 0.056942: : 5it [00:09,  2.00s/it]Train Epoch: 0 [6/62 (8%)] Loss: 0.056942: : 6it [00:09,  1.67s/it]Train Epoch: 0 [7/62 (10%)] Loss: 0.056768: : 6it [00:11,  1.86s/it]Train Epoch: 0 [7/62 (10%)] Loss: 0.056768: : 7it [00:11,  1.60s/it]Train Epoch: 0 [8/62 (11%)] Loss: 0.053881: : 7it [00:12,  1.77s/it]Train Epoch: 0 [8/62 (11%)] Loss: 0.053881: : 8it [00:12,  1.55s/it]Train Epoch: 0 [9/62 (13%)] Loss: 0.056430: : 8it [00:13,  1.68s/it]Train Epoch: 0 [9/62 (13%)] Loss: 0.056430: : 9it [00:13,  1.49s/it]Train Epoch: 0 [10/62 (15%)] Loss: 0.056028: : 9it [00:14,  1.61s/it]Train Epoch: 0 [10/62 (15%)] Loss: 0.056028: : 10it [00:14,  1.45s/it]Train Epoch: 0 [11/62 (16%)] Loss: 0.056780: : 10it [00:15,  1.55s/it]Train Epoch: 0 [11/62 (16%)] Loss: 0.056780: : 11it [00:15,  1.41s/it]Train Epoch: 0 [12/62 (18%)] Loss: 0.058134: : 11it [00:16,  1.50s/it]Train Epoch: 0 [12/62 (18%)] Loss: 0.058134: : 12it [00:16,  1.37s/it]Train Epoch: 0 [13/62 (19%)] Loss: 0.054535: : 12it [00:17,  1.45s/it]Train Epoch: 0 [13/62 (19%)] Loss: 0.054535: : 13it [00:17,  1.34s/it]Train Epoch: 0 [14/62 (21%)] Loss: 0.057800: : 13it [00:18,  1.44s/it]Train Epoch: 0 [14/62 (21%)] Loss: 0.057800: : 14it [00:18,  1.34s/it]Train Epoch: 0 [15/62 (23%)] Loss: 0.053286: : 14it [00:19,  1.41s/it]Train Epoch: 0 [15/62 (23%)] Loss: 0.053286: : 15it [00:19,  1.32s/it]Train Epoch: 0 [16/62 (24%)] Loss: 0.057655: : 15it [00:21,  1.41s/it]Train Epoch: 0 [16/62 (24%)] Loss: 0.057655: : 16it [00:21,  1.32s/it]Train Epoch: 0 [17/62 (26%)] Loss: 0.059486: : 16it [00:22,  1.40s/it]Train Epoch: 0 [17/62 (26%)] Loss: 0.059486: : 17it [00:22,  1.32s/it]Train Epoch: 0 [18/62 (27%)] Loss: 0.056389: : 17it [00:23,  1.39s/it]Train Epoch: 0 [18/62 (27%)] Loss: 0.056389: : 18it [00:23,  1.31s/it]Train Epoch: 0 [19/62 (29%)] Loss: 0.055584: : 18it [00:24,  1.39s/it]Train Epoch: 0 [19/62 (29%)] Loss: 0.055584: : 19it [00:24,  1.31s/it]Train Epoch: 0 [20/62 (31%)] Loss: 0.057883: : 19it [00:26,  1.41s/it]Train Epoch: 0 [20/62 (31%)] Loss: 0.057883: : 20it [00:26,  1.34s/it]Train Epoch: 0 [21/62 (32%)] Loss: 0.059403: : 20it [00:27,  1.39s/it]Train Epoch: 0 [21/62 (32%)] Loss: 0.059403: : 21it [00:27,  1.32s/it]Train Epoch: 0 [22/62 (34%)] Loss: 0.060355: : 21it [00:28,  1.37s/it]Train Epoch: 0 [22/62 (34%)] Loss: 0.060355: : 22it [00:28,  1.31s/it]Train Epoch: 0 [23/62 (35%)] Loss: 0.058910: : 22it [00:30,  1.36s/it]Train Epoch: 0 [23/62 (35%)] Loss: 0.058910: : 23it [00:30,  1.31s/it]Train Epoch: 0 [24/62 (37%)] Loss: 0.056520: : 23it [00:31,  1.35s/it]Train Epoch: 0 [24/62 (37%)] Loss: 0.056520: : 24it [00:31,  1.30s/it]Train Epoch: 0 [25/62 (39%)] Loss: 0.055137: : 24it [00:32,  1.34s/it]Train Epoch: 0 [25/62 (39%)] Loss: 0.055137: : 25it [00:32,  1.29s/it]Train Epoch: 0 [26/62 (40%)] Loss: 0.055041: : 25it [00:33,  1.34s/it]Train Epoch: 0 [26/62 (40%)] Loss: 0.055041: : 26it [00:33,  1.29s/it]Train Epoch: 0 [27/62 (42%)] Loss: 0.055370: : 26it [00:34,  1.33s/it]Train Epoch: 0 [27/62 (42%)] Loss: 0.055370: : 27it [00:34,  1.28s/it]Train Epoch: 0 [28/62 (44%)] Loss: 0.054136: : 27it [00:35,  1.33s/it]Train Epoch: 0 [28/62 (44%)] Loss: 0.054136: : 28it [00:35,  1.28s/it]Train Epoch: 0 [29/62 (45%)] Loss: 0.054802: : 28it [00:37,  1.32s/it]Train Epoch: 0 [29/62 (45%)] Loss: 0.054802: : 29it [00:37,  1.28s/it]Train Epoch: 0 [30/62 (47%)] Loss: 0.055954: : 29it [00:38,  1.32s/it]Train Epoch: 0 [30/62 (47%)] Loss: 0.055954: : 30it [00:38,  1.28s/it]Train Epoch: 0 [31/62 (48%)] Loss: 0.057394: : 30it [00:39,  1.31s/it]Train Epoch: 0 [31/62 (48%)] Loss: 0.057394: : 31it [00:39,  1.27s/it]Train Epoch: 0 [32/62 (50%)] Loss: 0.058742: : 31it [00:40,  1.30s/it]Train Epoch: 0 [32/62 (50%)] Loss: 0.058742: : 32it [00:40,  1.26s/it]Train Epoch: 0 [33/62 (52%)] Loss: 0.053903: : 32it [00:41,  1.30s/it]Train Epoch: 0 [33/62 (52%)] Loss: 0.053903: : 33it [00:41,  1.26s/it]Train Epoch: 0 [34/62 (53%)] Loss: 0.058827: : 33it [00:42,  1.30s/it]Train Epoch: 0 [34/62 (53%)] Loss: 0.058827: : 34it [00:42,  1.26s/it]Train Epoch: 0 [35/62 (55%)] Loss: 0.055134: : 34it [00:44,  1.29s/it]Train Epoch: 0 [35/62 (55%)] Loss: 0.055134: : 35it [00:44,  1.26s/it]Train Epoch: 0 [36/62 (56%)] Loss: 0.055051: : 35it [00:45,  1.29s/it]Train Epoch: 0 [36/62 (56%)] Loss: 0.055051: : 36it [00:45,  1.26s/it]Train Epoch: 0 [37/62 (58%)] Loss: 0.059033: : 36it [00:46,  1.29s/it]Train Epoch: 0 [37/62 (58%)] Loss: 0.059033: : 37it [00:46,  1.26s/it]Train Epoch: 0 [38/62 (60%)] Loss: 0.055456: : 37it [00:47,  1.29s/it]Train Epoch: 0 [38/62 (60%)] Loss: 0.055456: : 38it [00:47,  1.26s/it]Train Epoch: 0 [39/62 (61%)] Loss: 0.060650: : 38it [00:49,  1.30s/it]Train Epoch: 0 [39/62 (61%)] Loss: 0.060650: : 39it [00:49,  1.27s/it]Train Epoch: 0 [40/62 (63%)] Loss: 0.055885: : 39it [00:50,  1.30s/it]Train Epoch: 0 [40/62 (63%)] Loss: 0.055885: : 40it [00:50,  1.27s/it]Train Epoch: 0 [41/62 (65%)] Loss: 0.054356: : 40it [00:51,  1.30s/it]Train Epoch: 0 [41/62 (65%)] Loss: 0.054356: : 41it [00:51,  1.27s/it]Train Epoch: 0 [42/62 (66%)] Loss: 0.056756: : 41it [00:52,  1.29s/it]Train Epoch: 0 [42/62 (66%)] Loss: 0.056756: : 42it [00:52,  1.26s/it]Train Epoch: 0 [43/62 (68%)] Loss: 0.056560: : 42it [00:54,  1.29s/it]Train Epoch: 0 [43/62 (68%)] Loss: 0.056560: : 43it [00:54,  1.26s/it]Train Epoch: 0 [44/62 (69%)] Loss: 0.058149: : 43it [00:55,  1.30s/it]Train Epoch: 0 [44/62 (69%)] Loss: 0.058149: : 44it [00:55,  1.27s/it]Train Epoch: 0 [45/62 (71%)] Loss: 0.056250: : 44it [00:56,  1.29s/it]Train Epoch: 0 [45/62 (71%)] Loss: 0.056250: : 45it [00:56,  1.26s/it]Train Epoch: 0 [46/62 (73%)] Loss: 0.057856: : 45it [00:57,  1.29s/it]Train Epoch: 0 [46/62 (73%)] Loss: 0.057856: : 46it [00:57,  1.26s/it]Train Epoch: 0 [47/62 (74%)] Loss: 0.060004: : 46it [00:59,  1.29s/it]Train Epoch: 0 [47/62 (74%)] Loss: 0.060004: : 47it [00:59,  1.26s/it]Train Epoch: 0 [48/62 (76%)] Loss: 0.052229: : 47it [01:00,  1.29s/it]Train Epoch: 0 [48/62 (76%)] Loss: 0.052229: : 48it [01:00,  1.27s/it]Train Epoch: 0 [49/62 (77%)] Loss: 0.057634: : 48it [01:01,  1.29s/it]Train Epoch: 0 [49/62 (77%)] Loss: 0.057634: : 49it [01:01,  1.26s/it]Train Epoch: 0 [50/62 (79%)] Loss: 0.053630: : 49it [01:02,  1.28s/it]Train Epoch: 0 [50/62 (79%)] Loss: 0.053630: : 50it [01:02,  1.26s/it]Train Epoch: 0 [51/62 (81%)] Loss: 0.054489: : 50it [01:03,  1.28s/it]Train Epoch: 0 [51/62 (81%)] Loss: 0.054489: : 51it [01:03,  1.25s/it]Train Epoch: 0 [52/62 (82%)] Loss: 0.057604: : 51it [01:05,  1.27s/it]Train Epoch: 0 [52/62 (82%)] Loss: 0.057604: : 52it [01:05,  1.25s/it]Train Epoch: 0 [53/62 (84%)] Loss: 0.064951: : 52it [01:06,  1.27s/it]Train Epoch: 0 [53/62 (84%)] Loss: 0.064951: : 53it [01:06,  1.25s/it]Train Epoch: 0 [54/62 (85%)] Loss: 0.059054: : 53it [01:07,  1.28s/it]Train Epoch: 0 [54/62 (85%)] Loss: 0.059054: : 54it [01:07,  1.25s/it]Train Epoch: 0 [55/62 (87%)] Loss: 0.056564: : 54it [01:08,  1.28s/it]Train Epoch: 0 [55/62 (87%)] Loss: 0.056564: : 55it [01:08,  1.25s/it]Train Epoch: 0 [56/62 (89%)] Loss: 0.053622: : 55it [01:10,  1.28s/it]Train Epoch: 0 [56/62 (89%)] Loss: 0.053622: : 56it [01:10,  1.26s/it]Train Epoch: 0 [57/62 (90%)] Loss: 0.057646: : 56it [01:11,  1.28s/it]Train Epoch: 0 [57/62 (90%)] Loss: 0.057646: : 57it [01:11,  1.26s/it]Train Epoch: 0 [58/62 (92%)] Loss: 0.055403: : 57it [01:12,  1.28s/it]Train Epoch: 0 [58/62 (92%)] Loss: 0.055403: : 58it [01:12,  1.26s/it]Train Epoch: 0 [59/62 (94%)] Loss: 0.056819: : 58it [01:14,  1.28s/it]Train Epoch: 0 [59/62 (94%)] Loss: 0.056819: : 59it [01:14,  1.26s/it]Train Epoch: 0 [60/62 (95%)] Loss: 0.053529: : 59it [01:15,  1.28s/it]Train Epoch: 0 [60/62 (95%)] Loss: 0.053529: : 60it [01:15,  1.26s/it]Train Epoch: 0 [61/62 (97%)] Loss: 0.057432: : 60it [01:16,  1.28s/it]Train Epoch: 0 [61/62 (97%)] Loss: 0.057432: : 61it [01:16,  1.26s/it]Train Epoch: 0 [62/62 (98%)] Loss: 0.054428: : 61it [01:17,  1.28s/it]Train Epoch: 0 [62/62 (98%)] Loss: 0.054428: : 62it [01:17,  1.25s/it]
**Evaluating...**
Traceback (most recent call last):
  File "C:/Users/Juhyeon/Desktop/repository/Proxy-Anchor-CVPR2020/code/train.py", line 322, in <module>
    Recalls = utils.evaluate_cos(model, dl_ev)
  File "C:\Users\Juhyeon\Desktop\repository\Proxy-Anchor-CVPR2020\code\utils.py", line 70, in evaluate_cos
    X, T = predict_batchwise(model, dataloader)
  File "C:\Users\Juhyeon\Desktop\repository\Proxy-Anchor-CVPR2020\code\utils.py", line 39, in predict_batchwise
    A = [[] for i in range(len(ds[0]))]
  File "C:\Users\Juhyeon\Desktop\repository\Proxy-Anchor-CVPR2020\code\dataset\base.py", line 36, in __getitem__
    im = corrupt(im, corruption_name='gaussian_noise', severity=1)
  File "C:\Users\Juhyeon\anaconda3\envs\torch17\lib\site-packages\imagenet_c\__init__.py", line 29, in corrupt
    x_corrupted = corruption_dict[corruption_name](Image.fromarray(x), severity)
  File "C:\Users\Juhyeon\anaconda3\envs\torch17\lib\site-packages\PIL\Image.py", line 2453, in fromarray
    arr = obj.__array_interface__
AttributeError: 'Tensor' object has no attribute '__array_interface__'
Backend Qt5Agg is interactive backend. Turning interactive mode on.
