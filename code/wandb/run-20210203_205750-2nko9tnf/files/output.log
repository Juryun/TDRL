Random Sampling
Downloading: "https://download.pytorch.org/models/googlenet-1378be20.pth" to C:\Users\Juhyeon/.cache\torch\hub\checkpoints\googlenet-1378be20.pth
  0%|          | 0.00/49.7M [00:00<?, ?B/s] 16%|█▌        | 7.97M/49.7M [00:00<00:00, 83.5MB/s] 36%|███▌      | 17.9M/49.7M [00:00<00:00, 87.3MB/s] 59%|█████▉    | 29.3M/49.7M [00:00<00:00, 94.8MB/s] 81%|████████▏ | 40.4M/49.7M [00:00<00:00, 100MB/s] 100%|██████████| 49.7M/49.7M [00:00<00:00, 104MB/s]
Training parameters: {'LOG_DIR': '../logs', 'dataset': 'cars', 'sz_embedding': 512, 'sz_batch': 180, 'nb_epochs': 60, 'gpu_id': 0, 'nb_workers': 0, 'model': 'googlenet', 'loss': 'Triplet', 'optimizer': 'adamw', 'lr': 0.0001, 'weight_decay': 0.0001, 'lr_decay_step': 20, 'lr_decay_gamma': 0.5, 'alpha': 32, 'mrg': 0.1, 'IPC': None, 'warm': 1, 'bn_freeze': 1, 'l2_norm': 1, 'remark': ''}
Training for 60 epochs.
0it [00:00, ?it/s]Train Epoch: 0 [1/44 (0%)] Loss: 0.052473: : 0it [00:03, ?it/s]Train Epoch: 0 [1/44 (0%)] Loss: 0.052473: : 1it [00:03,  3.29s/it]Train Epoch: 0 [2/44 (2%)] Loss: 0.050865: : 1it [00:04,  4.99s/it]Train Epoch: 0 [2/44 (2%)] Loss: 0.050865: : 2it [00:04,  2.49s/it]Train Epoch: 0 [3/44 (5%)] Loss: 0.050711: : 2it [00:06,  3.47s/it]Train Epoch: 0 [3/44 (5%)] Loss: 0.050711: : 3it [00:06,  2.31s/it]Train Epoch: 0 [4/44 (7%)] Loss: 0.051352: : 3it [00:08,  2.85s/it]Train Epoch: 0 [4/44 (7%)] Loss: 0.051352: : 4it [00:08,  2.14s/it]Train Epoch: 0 [5/44 (9%)] Loss: 0.050110: : 4it [00:10,  2.50s/it]Train Epoch: 0 [5/44 (9%)] Loss: 0.050110: : 5it [00:10,  2.00s/it]Train Epoch: 0 [6/44 (11%)] Loss: 0.050654: : 5it [00:11,  2.29s/it]Train Epoch: 0 [6/44 (11%)] Loss: 0.050654: : 6it [00:11,  1.91s/it]Train Epoch: 0 [7/44 (14%)] Loss: 0.050430: : 6it [00:12,  2.14s/it]Train Epoch: 0 [7/44 (14%)] Loss: 0.050430: : 7it [00:12,  1.83s/it]Train Epoch: 0 [8/44 (16%)] Loss: 0.050248: : 7it [00:14,  2.03s/it]Train Epoch: 0 [8/44 (16%)] Loss: 0.050248: : 8it [00:14,  1.77s/it]Train Epoch: 0 [9/44 (18%)] Loss: 0.052040: : 8it [00:15,  1.94s/it]Train Epoch: 0 [9/44 (18%)] Loss: 0.052040: : 9it [00:15,  1.73s/it]Train Epoch: 0 [10/44 (20%)] Loss: 0.050591: : 9it [00:17,  1.90s/it]Train Epoch: 0 [10/44 (20%)] Loss: 0.050591: : 10it [00:17,  1.71s/it]Train Epoch: 0 [11/44 (23%)] Loss: 0.050671: : 10it [00:18,  1.85s/it]Train Epoch: 0 [11/44 (23%)] Loss: 0.050671: : 11it [00:18,  1.68s/it]Train Epoch: 0 [12/44 (25%)] Loss: 0.049849: : 11it [00:20,  1.84s/it]Train Epoch: 0 [12/44 (25%)] Loss: 0.049849: : 12it [00:20,  1.69s/it]Train Epoch: 0 [13/44 (27%)] Loss: 0.050504: : 12it [00:21,  1.83s/it]Train Epoch: 0 [13/44 (27%)] Loss: 0.050504: : 13it [00:21,  1.69s/it]Train Epoch: 0 [14/44 (30%)] Loss: 0.050414: : 13it [00:24,  1.86s/it]Train Epoch: 0 [14/44 (30%)] Loss: 0.050414: : 14it [00:24,  1.73s/it]Train Epoch: 0 [15/44 (32%)] Loss: 0.051323: : 14it [00:25,  1.83s/it]Train Epoch: 0 [15/44 (32%)] Loss: 0.051323: : 15it [00:25,  1.70s/it]Train Epoch: 0 [16/44 (34%)] Loss: 0.049904: : 15it [00:27,  1.81s/it]Train Epoch: 0 [16/44 (34%)] Loss: 0.049904: : 16it [00:27,  1.69s/it]Train Epoch: 0 [17/44 (36%)] Loss: 0.050687: : 16it [00:28,  1.79s/it]Train Epoch: 0 [17/44 (36%)] Loss: 0.050687: : 17it [00:28,  1.68s/it]Train Epoch: 0 [18/44 (39%)] Loss: 0.049961: : 17it [00:30,  1.77s/it]Train Epoch: 0 [18/44 (39%)] Loss: 0.049961: : 18it [00:30,  1.67s/it]Train Epoch: 0 [19/44 (41%)] Loss: 0.050050: : 18it [00:31,  1.76s/it]Train Epoch: 0 [19/44 (41%)] Loss: 0.050050: : 19it [00:31,  1.66s/it]Train Epoch: 0 [20/44 (43%)] Loss: 0.049498: : 19it [00:33,  1.74s/it]Train Epoch: 0 [20/44 (43%)] Loss: 0.049498: : 20it [00:33,  1.66s/it]Train Epoch: 0 [21/44 (45%)] Loss: 0.050190: : 20it [00:34,  1.74s/it]Train Epoch: 0 [21/44 (45%)] Loss: 0.050190: : 21it [00:34,  1.66s/it]Train Epoch: 0 [22/44 (48%)] Loss: 0.050233: : 21it [00:36,  1.72s/it]Train Epoch: 0 [22/44 (48%)] Loss: 0.050233: : 22it [00:36,  1.64s/it]Train Epoch: 0 [23/44 (50%)] Loss: 0.050166: : 22it [00:37,  1.70s/it]Train Epoch: 0 [23/44 (50%)] Loss: 0.050166: : 23it [00:37,  1.62s/it]Train Epoch: 0 [24/44 (52%)] Loss: 0.049659: : 23it [00:39,  1.70s/it]Train Epoch: 0 [24/44 (52%)] Loss: 0.049659: : 24it [00:39,  1.63s/it]Train Epoch: 0 [25/44 (55%)] Loss: 0.050018: : 24it [00:40,  1.69s/it]Train Epoch: 0 [25/44 (55%)] Loss: 0.050018: : 25it [00:40,  1.63s/it]Train Epoch: 0 [26/44 (57%)] Loss: 0.049958: : 25it [00:42,  1.69s/it]Train Epoch: 0 [26/44 (57%)] Loss: 0.049958: : 26it [00:42,  1.63s/it]Train Epoch: 0 [27/44 (59%)] Loss: 0.048814: : 26it [00:44,  1.70s/it]Train Epoch: 0 [27/44 (59%)] Loss: 0.048814: : 27it [00:44,  1.63s/it]Train Epoch: 0 [28/44 (61%)] Loss: 0.050344: : 27it [00:45,  1.70s/it]Train Epoch: 0 [28/44 (61%)] Loss: 0.050344: : 28it [00:45,  1.64s/it]Train Epoch: 0 [29/44 (64%)] Loss: 0.050609: : 28it [00:47,  1.70s/it]Train Epoch: 0 [29/44 (64%)] Loss: 0.050609: : 29it [00:47,  1.64s/it]Train Epoch: 0 [30/44 (66%)] Loss: 0.049546: : 29it [00:49,  1.69s/it]Train Epoch: 0 [30/44 (66%)] Loss: 0.049546: : 30it [00:49,  1.64s/it]Train Epoch: 0 [31/44 (68%)] Loss: 0.050179: : 30it [00:50,  1.69s/it]Train Epoch: 0 [31/44 (68%)] Loss: 0.050179: : 31it [00:50,  1.63s/it]Train Epoch: 0 [32/44 (70%)] Loss: 0.050052: : 31it [00:52,  1.69s/it]Train Epoch: 0 [32/44 (70%)] Loss: 0.050052: : 32it [00:52,  1.64s/it]Train Epoch: 0 [33/44 (73%)] Loss: 0.050278: : 32it [00:54,  1.69s/it]Train Epoch: 0 [33/44 (73%)] Loss: 0.050278: : 33it [00:54,  1.64s/it]Train Epoch: 0 [34/44 (75%)] Loss: 0.049657: : 33it [00:55,  1.70s/it]Train Epoch: 0 [34/44 (75%)] Loss: 0.049657: : 34it [00:55,  1.65s/it]Train Epoch: 0 [35/44 (77%)] Loss: 0.050651: : 34it [00:57,  1.69s/it]Train Epoch: 0 [35/44 (77%)] Loss: 0.050651: : 35it [00:57,  1.64s/it]Train Epoch: 0 [36/44 (80%)] Loss: 0.049535: : 35it [00:58,  1.68s/it]Train Epoch: 0 [36/44 (80%)] Loss: 0.049535: : 36it [00:58,  1.63s/it]Train Epoch: 0 [37/44 (82%)] Loss: 0.049830: : 36it [01:00,  1.67s/it]Train Epoch: 0 [37/44 (82%)] Loss: 0.049830: : 37it [01:00,  1.63s/it]Train Epoch: 0 [38/44 (84%)] Loss: 0.049163: : 37it [01:02,  1.68s/it]Train Epoch: 0 [38/44 (84%)] Loss: 0.049163: : 38it [01:02,  1.64s/it]Train Epoch: 0 [39/44 (86%)] Loss: 0.049973: : 38it [01:03,  1.68s/it]Train Epoch: 0 [39/44 (86%)] Loss: 0.049973: : 39it [01:03,  1.63s/it]Train Epoch: 0 [40/44 (89%)] Loss: 0.049953: : 39it [01:05,  1.68s/it]Train Epoch: 0 [40/44 (89%)] Loss: 0.049953: : 40it [01:05,  1.64s/it]Train Epoch: 0 [41/44 (91%)] Loss: 0.049440: : 40it [01:07,  1.68s/it]Train Epoch: 0 [41/44 (91%)] Loss: 0.049440: : 41it [01:07,  1.64s/it]Train Epoch: 0 [42/44 (93%)] Loss: 0.049295: : 41it [01:09,  1.69s/it]Train Epoch: 0 [42/44 (93%)] Loss: 0.049295: : 42it [01:09,  1.65s/it]Train Epoch: 0 [43/44 (95%)] Loss: 0.050393: : 42it [01:10,  1.68s/it]Train Epoch: 0 [43/44 (95%)] Loss: 0.050393: : 43it [01:10,  1.65s/it]Train Epoch: 0 [44/44 (98%)] Loss: 0.049997: : 43it [01:12,  1.68s/it]Train Epoch: 0 [44/44 (98%)] Loss: 0.049997: : 44it [01:12,  1.64s/it]
**Evaluating...**
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:01<01:19,  1.77s/it]  4%|▍         | 2/46 [00:03<01:18,  1.78s/it]  7%|▋         | 3/46 [00:05<01:12,  1.68s/it]  9%|▊         | 4/46 [00:06<01:07,  1.61s/it] 11%|█         | 5/46 [00:07<01:03,  1.54s/it] 13%|█▎        | 6/46 [00:09<01:03,  1.59s/it] 15%|█▌        | 7/46 [00:11<01:05,  1.68s/it] 17%|█▋        | 8/46 [00:13<01:02,  1.64s/it] 20%|█▉        | 9/46 [00:14<00:58,  1.57s/it] 22%|██▏       | 10/46 [00:15<00:55,  1.54s/it] 24%|██▍       | 11/46 [00:16<00:52,  1.51s/it] 26%|██▌       | 12/46 [00:17<00:50,  1.50s/it] 28%|██▊       | 13/46 [00:19<00:49,  1.49s/it] 30%|███       | 14/46 [00:21<00:48,  1.50s/it] 33%|███▎      | 15/46 [00:22<00:46,  1.49s/it] 35%|███▍      | 16/46 [00:23<00:44,  1.50s/it] 37%|███▋      | 17/46 [00:25<00:43,  1.51s/it] 39%|███▉      | 18/46 [00:26<00:41,  1.50s/it] 41%|████▏     | 19/46 [00:28<00:40,  1.50s/it] 43%|████▎     | 20/46 [00:30<00:40,  1.55s/it] 46%|████▌     | 21/46 [00:32<00:38,  1.55s/it] 48%|████▊     | 22/46 [00:35<00:38,  1.62s/it] 50%|█████     | 23/46 [00:38<00:38,  1.66s/it] 52%|█████▏    | 24/46 [00:41<00:37,  1.72s/it] 54%|█████▍    | 25/46 [00:43<00:36,  1.72s/it] 57%|█████▋    | 26/46 [00:44<00:34,  1.72s/it] 59%|█████▊    | 27/46 [00:46<00:32,  1.71s/it] 61%|██████    | 28/46 [00:47<00:30,  1.70s/it] 63%|██████▎   | 29/46 [00:49<00:28,  1.70s/it] 65%|██████▌   | 30/46 [00:51<00:27,  1.72s/it] 67%|██████▋   | 31/46 [00:54<00:26,  1.75s/it] 70%|██████▉   | 32/46 [00:57<00:25,  1.81s/it] 72%|███████▏  | 33/46 [01:01<00:24,  1.85s/it] 74%|███████▍  | 34/46 [01:03<00:22,  1.87s/it] 76%|███████▌  | 35/46 [01:05<00:20,  1.87s/it] 78%|███████▊  | 36/46 [01:07<00:18,  1.87s/it] 80%|████████  | 37/46 [01:08<00:16,  1.86s/it] 83%|████████▎ | 38/46 [01:10<00:14,  1.86s/it] 85%|████████▍ | 39/46 [01:13<00:13,  1.88s/it] 87%|████████▋ | 40/46 [01:15<00:11,  1.89s/it] 89%|████████▉ | 41/46 [01:17<00:09,  1.88s/it] 91%|█████████▏| 42/46 [01:18<00:07,  1.87s/it] 93%|█████████▎| 43/46 [01:20<00:05,  1.88s/it] 96%|█████████▌| 44/46 [01:23<00:03,  1.89s/it] 98%|█████████▊| 45/46 [01:24<00:01,  1.88s/it]100%|██████████| 46/46 [01:24<00:00,  1.85s/it]
R@1 : 30.168
R@2 : 40.708
R@4 : 52.601
R@8 : 64.949
R@16 : 76.362
R@32 : 85.869
0it [00:00, ?it/s]Traceback (most recent call last):
  File "C:/Users/Juhyeon/Desktop/repository/Proxy-Anchor-CVPR2020/code/train.py", line 295, in <module>
    loss.backward()
  File "C:\Users\Juhyeon\anaconda3\envs\torch17\lib\site-packages\torch\tensor.py", line 221, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "C:\Users\Juhyeon\anaconda3\envs\torch17\lib\site-packages\torch\autograd\__init__.py", line 132, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: CUDA out of memory. Tried to allocate 36.00 MiB (GPU 0; 11.00 GiB total capacity; 8.18 GiB already allocated; 31.74 MiB free; 8.24 GiB reserved in total by PyTorch)
