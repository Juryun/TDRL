Random Sampling
Training parameters: {'LOG_DIR': '../logs', 'dataset': 'cars', 'sz_embedding': 512, 'sz_batch': 192, 'nb_epochs': 60, 'gpu_id': 0, 'nb_workers': 0, 'model': 'googlenet', 'loss': 'TripletPCA2', 'optimizer': 'adamw', 'lr': 0.0001, 'weight_decay': 0.0001, 'lr_decay_step': 20, 'lr_decay_gamma': 0.5, 'alpha': 32, 'mrg': 0.1, 'IPC': None, 'warm': 1, 'bn_freeze': 1, 'l2_norm': 1, 'remark': ''}
Training for 60 epochs.
0it [00:00, ?it/s]Train Epoch: 0 [1/41 (0%)] Loss: 0.054766: : 0it [00:03, ?it/s]Train Epoch: 0 [1/41 (0%)] Loss: 0.054766: : 1it [00:03,  3.68s/it]Train Epoch: 0 [2/41 (2%)] Loss: 0.054906: : 1it [00:05,  5.51s/it]Train Epoch: 0 [2/41 (2%)] Loss: 0.054906: : 2it [00:05,  2.75s/it]Train Epoch: 0 [3/41 (5%)] Loss: 0.054060: : 2it [00:07,  3.75s/it]Train Epoch: 0 [3/41 (5%)] Loss: 0.054060: : 3it [00:07,  2.50s/it]Train Epoch: 0 [4/41 (7%)] Loss: 0.054894: : 3it [00:09,  3.06s/it]Train Epoch: 0 [4/41 (7%)] Loss: 0.054894: : 4it [00:09,  2.30s/it]Train Epoch: 0 [5/41 (10%)] Loss: 0.053750: : 4it [00:10,  2.71s/it]Train Epoch: 0 [5/41 (10%)] Loss: 0.053750: : 5it [00:10,  2.17s/it]Train Epoch: 0 [6/41 (12%)] Loss: 0.055032: : 5it [00:12,  2.51s/it]Train Epoch: 0 [6/41 (12%)] Loss: 0.055032: : 6it [00:12,  2.09s/it]Train Epoch: 0 [7/41 (15%)] Loss: 0.055010: : 6it [00:14,  2.34s/it]Train Epoch: 0 [7/41 (15%)] Loss: 0.055010: : 7it [00:14,  2.01s/it]Train Epoch: 0 [8/41 (17%)] Loss: 0.056793: : 7it [00:15,  2.23s/it]Train Epoch: 0 [8/41 (17%)] Loss: 0.056793: : 8it [00:15,  1.95s/it]Train Epoch: 0 [9/41 (20%)] Loss: 0.055319: : 8it [00:17,  2.14s/it]Train Epoch: 0 [9/41 (20%)] Loss: 0.055319: : 9it [00:17,  1.91s/it]Train Epoch: 0 [10/41 (22%)] Loss: 0.055291: : 9it [00:18,  2.08s/it]Train Epoch: 0 [10/41 (22%)] Loss: 0.055291: : 10it [00:18,  1.87s/it]Train Epoch: 0 [11/41 (24%)] Loss: 0.056100: : 10it [00:20,  2.07s/it]Train Epoch: 0 [11/41 (24%)] Loss: 0.056100: : 11it [00:20,  1.88s/it]Train Epoch: 0 [12/41 (27%)] Loss: 0.056133: : 11it [00:22,  2.05s/it]Train Epoch: 0 [12/41 (27%)] Loss: 0.056133: : 12it [00:22,  1.88s/it]Train Epoch: 0 [13/41 (29%)] Loss: 0.053699: : 12it [00:24,  2.06s/it]Train Epoch: 0 [13/41 (29%)] Loss: 0.053699: : 13it [00:24,  1.90s/it]Train Epoch: 0 [14/41 (32%)] Loss: 0.054850: : 13it [00:26,  2.04s/it]Train Epoch: 0 [14/41 (32%)] Loss: 0.054850: : 14it [00:26,  1.90s/it]Train Epoch: 0 [15/41 (34%)] Loss: 0.055788: : 14it [00:28,  2.02s/it]Train Epoch: 0 [15/41 (34%)] Loss: 0.055788: : 15it [00:28,  1.88s/it]Train Epoch: 0 [16/41 (37%)] Loss: 0.055906: : 15it [00:29,  1.99s/it]Train Epoch: 0 [16/41 (37%)] Loss: 0.055906: : 16it [00:29,  1.87s/it]Train Epoch: 0 [17/41 (39%)] Loss: 0.056159: : 16it [00:31,  1.99s/it]Train Epoch: 0 [17/41 (39%)] Loss: 0.056159: : 17it [00:31,  1.87s/it]Train Epoch: 0 [18/41 (41%)] Loss: 0.054274: : 17it [00:33,  1.96s/it]Train Epoch: 0 [18/41 (41%)] Loss: 0.054274: : 18it [00:33,  1.85s/it]Train Epoch: 0 [19/41 (44%)] Loss: 0.053423: : 18it [00:34,  1.94s/it]Train Epoch: 0 [19/41 (44%)] Loss: 0.053423: : 19it [00:34,  1.84s/it]Train Epoch: 0 [20/41 (46%)] Loss: 0.054753: : 19it [00:36,  1.94s/it]Train Epoch: 0 [20/41 (46%)] Loss: 0.054753: : 20it [00:36,  1.84s/it]Train Epoch: 0 [21/41 (49%)] Loss: 0.057153: : 20it [00:38,  1.91s/it]Train Epoch: 0 [21/41 (49%)] Loss: 0.057153: : 21it [00:38,  1.82s/it]Train Epoch: 0 [22/41 (51%)] Loss: 0.056361: : 21it [00:39,  1.90s/it]Train Epoch: 0 [22/41 (51%)] Loss: 0.056361: : 22it [00:39,  1.82s/it]Train Epoch: 0 [23/41 (54%)] Loss: 0.055354: : 22it [00:42,  1.91s/it]Train Epoch: 0 [23/41 (54%)] Loss: 0.055354: : 23it [00:42,  1.83s/it]Train Epoch: 0 [24/41 (56%)] Loss: 0.055796: : 23it [00:43,  1.90s/it]Train Epoch: 0 [24/41 (56%)] Loss: 0.055796: : 24it [00:43,  1.82s/it]Train Epoch: 0 [25/41 (59%)] Loss: 0.054215: : 24it [00:45,  1.90s/it]Train Epoch: 0 [25/41 (59%)] Loss: 0.054215: : 25it [00:45,  1.82s/it]Train Epoch: 0 [26/41 (61%)] Loss: 0.056185: : 25it [00:47,  1.91s/it]Train Epoch: 0 [26/41 (61%)] Loss: 0.056185: : 26it [00:47,  1.84s/it]Train Epoch: 0 [27/41 (63%)] Loss: 0.054835: : 26it [00:49,  1.91s/it]Train Epoch: 0 [27/41 (63%)] Loss: 0.054835: : 27it [00:49,  1.84s/it]Train Epoch: 0 [28/41 (66%)] Loss: 0.052839: : 27it [00:51,  1.90s/it]Train Epoch: 0 [28/41 (66%)] Loss: 0.052839: : 28it [00:51,  1.83s/it]Train Epoch: 0 [29/41 (68%)] Loss: 0.056088: : 28it [00:52,  1.89s/it]Train Epoch: 0 [29/41 (68%)] Loss: 0.056088: : 29it [00:52,  1.83s/it]Train Epoch: 0 [30/41 (71%)] Loss: 0.054789: : 29it [00:55,  1.90s/it]Train Epoch: 0 [30/41 (71%)] Loss: 0.054789: : 30it [00:55,  1.83s/it]Train Epoch: 0 [31/41 (73%)] Loss: 0.058547: : 30it [00:56,  1.90s/it]Train Epoch: 0 [31/41 (73%)] Loss: 0.058547: : 31it [00:56,  1.83s/it]Train Epoch: 0 [32/41 (76%)] Loss: 0.055743: : 31it [00:58,  1.90s/it]Train Epoch: 0 [32/41 (76%)] Loss: 0.055743: : 32it [00:58,  1.84s/it]Train Epoch: 0 [33/41 (78%)] Loss: 0.053601: : 32it [01:00,  1.89s/it]Train Epoch: 0 [33/41 (78%)] Loss: 0.053601: : 33it [01:00,  1.83s/it]Train Epoch: 0 [34/41 (80%)] Loss: 0.053928: : 33it [01:01,  1.88s/it]Train Epoch: 0 [34/41 (80%)] Loss: 0.053928: : 34it [01:01,  1.82s/it]Train Epoch: 0 [35/41 (83%)] Loss: 0.053187: : 34it [01:03,  1.87s/it]Train Epoch: 0 [35/41 (83%)] Loss: 0.053187: : 35it [01:03,  1.82s/it]Train Epoch: 0 [36/41 (85%)] Loss: 0.054554: : 35it [01:05,  1.88s/it]Train Epoch: 0 [36/41 (85%)] Loss: 0.054554: : 36it [01:05,  1.83s/it]Train Epoch: 0 [37/41 (88%)] Loss: 0.053900: : 36it [01:07,  1.88s/it]Train Epoch: 0 [37/41 (88%)] Loss: 0.053900: : 37it [01:07,  1.83s/it]Train Epoch: 0 [38/41 (90%)] Loss: 0.059400: : 37it [01:09,  1.88s/it]Train Epoch: 0 [38/41 (90%)] Loss: 0.059400: : 38it [01:09,  1.83s/it]Train Epoch: 0 [39/41 (93%)] Loss: 0.052988: : 38it [01:11,  1.88s/it]Train Epoch: 0 [39/41 (93%)] Loss: 0.052988: : 39it [01:11,  1.84s/it]Train Epoch: 0 [40/41 (95%)] Loss: 0.052114: : 39it [01:13,  1.88s/it]Train Epoch: 0 [40/41 (95%)] Loss: 0.052114: : 40it [01:13,  1.84s/it]Train Epoch: 0 [41/41 (98%)] Loss: 0.056414: : 40it [01:15,  1.88s/it]Train Epoch: 0 [41/41 (98%)] Loss: 0.056414: : 41it [01:15,  1.83s/it]
**Evaluating...**
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:01<01:21,  1.95s/it]  5%|▍         | 2/43 [00:03<01:19,  1.93s/it]  7%|▋         | 3/43 [00:05<01:11,  1.79s/it]  9%|▉         | 4/43 [00:06<01:06,  1.70s/it] 12%|█▏        | 5/43 [00:08<01:04,  1.69s/it] 14%|█▍        | 6/43 [00:11<01:09,  1.87s/it] 16%|█▋        | 7/43 [00:12<01:05,  1.81s/it] 19%|█▊        | 8/43 [00:13<01:00,  1.74s/it] 21%|██        | 9/43 [00:15<00:57,  1.68s/it] 23%|██▎       | 10/43 [00:16<00:54,  1.65s/it] 26%|██▌       | 11/43 [00:18<00:52,  1.65s/it] 28%|██▊       | 12/43 [00:19<00:50,  1.64s/it] 30%|███       | 13/43 [00:21<00:49,  1.65s/it] 33%|███▎      | 14/43 [00:22<00:47,  1.63s/it] 35%|███▍      | 15/43 [00:24<00:45,  1.64s/it] 37%|███▋      | 16/43 [00:26<00:44,  1.65s/it] 40%|███▉      | 17/43 [00:27<00:42,  1.64s/it] 42%|████▏     | 18/43 [00:30<00:41,  1.67s/it] 44%|████▍     | 19/43 [00:32<00:40,  1.68s/it] 47%|████▋     | 20/43 [00:34<00:39,  1.72s/it] 49%|████▉     | 21/43 [00:37<00:39,  1.80s/it] 51%|█████     | 22/43 [00:41<00:39,  1.86s/it] 53%|█████▎    | 23/43 [00:43<00:37,  1.87s/it] 56%|█████▌    | 24/43 [00:45<00:35,  1.88s/it] 58%|█████▊    | 25/43 [00:46<00:33,  1.87s/it] 60%|██████    | 26/43 [00:48<00:31,  1.85s/it] 63%|██████▎   | 27/43 [00:50<00:29,  1.85s/it] 65%|██████▌   | 28/43 [00:52<00:27,  1.86s/it] 67%|██████▋   | 29/43 [00:55<00:26,  1.90s/it] 70%|██████▉   | 30/43 [00:58<00:25,  1.96s/it] 72%|███████▏  | 31/43 [01:02<00:24,  2.02s/it] 74%|███████▍  | 32/43 [01:04<00:22,  2.03s/it] 77%|███████▋  | 33/43 [01:06<00:20,  2.02s/it] 79%|███████▉  | 34/43 [01:08<00:18,  2.02s/it] 81%|████████▏ | 35/43 [01:10<00:16,  2.02s/it] 84%|████████▎ | 36/43 [01:12<00:14,  2.02s/it] 86%|████████▌ | 37/43 [01:15<00:12,  2.04s/it] 88%|████████▊ | 38/43 [01:17<00:10,  2.03s/it] 91%|█████████ | 39/43 [01:19<00:08,  2.03s/it] 93%|█████████▎| 40/43 [01:21<00:06,  2.03s/it] 95%|█████████▌| 41/43 [01:23<00:04,  2.04s/it] 98%|█████████▊| 42/43 [01:25<00:02,  2.04s/it]100%|██████████| 43/43 [01:26<00:00,  2.00s/it]
R@1 : 31.398
R@2 : 42.713
R@4 : 55.590
R@8 : 67.802
R@16 : 79.326
R@32 : 88.833
0it [00:00, ?it/s]Traceback (most recent call last):
  File "C:/Users/Juhyeon/Desktop/repository/Proxy-Anchor-CVPR2020/code/train.py", line 301, in <module>
    m = model(x.squeeze().cuda())
  File "C:\Users\Juhyeon\anaconda3\envs\torch17\lib\site-packages\torch\nn\modules\module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "C:\Users\Juhyeon\Desktop\repository\Proxy-Anchor-CVPR2020\code\net\googlenet.py", line 235, in forward
    x = self.model.inception4e(x)
  File "C:\Users\Juhyeon\anaconda3\envs\torch17\lib\site-packages\torch\nn\modules\module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "C:\Users\Juhyeon\Desktop\repository\Proxy-Anchor-CVPR2020\code\net\googlenet.py", line 141, in forward
    return torch.cat(outputs, 1)
RuntimeError: CUDA out of memory. Tried to allocate 120.00 MiB (GPU 0; 11.00 GiB total capacity; 8.11 GiB already allocated; 55.74 MiB free; 8.18 GiB reserved in total by PyTorch)
