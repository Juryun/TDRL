Random Sampling
Training parameters: {'LOG_DIR': '../logs', 'dataset': 'cub', 'sz_embedding': 512, 'sz_batch': 128, 'nb_epochs': 1, 'gpu_id': 0, 'nb_workers': 0, 'model': 'googlenet', 'loss': 'TripletPCA2', 'optimizer': 'adamw', 'lr': 0.0001, 'weight_decay': 0.0001, 'lr_decay_step': 20, 'lr_decay_gamma': 0.5, 'alpha': 32, 'mrg': 0.1, 'IPC': None, 'warm': 1, 'bn_freeze': 1, 'l2_norm': 1, 'remark': ''}
Training for 1 epochs.
0it [00:00, ?it/s]Train Epoch: 0 [1/45 (0%)] Loss: 0.055996: : 0it [00:03, ?it/s]Train Epoch: 0 [1/45 (0%)] Loss: 0.055996: : 1it [00:03,  3.94s/it]Train Epoch: 0 [2/45 (2%)] Loss: 0.052225: : 1it [00:04,  4.89s/it]Train Epoch: 0 [2/45 (2%)] Loss: 0.052225: : 2it [00:04,  2.44s/it]Train Epoch: 0 [3/45 (4%)] Loss: 0.056999: : 2it [00:05,  2.88s/it]Train Epoch: 0 [3/45 (4%)] Loss: 0.056999: : 3it [00:05,  1.92s/it]Train Epoch: 0 [4/45 (7%)] Loss: 0.051486: : 3it [00:06,  2.21s/it]Train Epoch: 0 [4/45 (7%)] Loss: 0.051486: : 4it [00:06,  1.66s/it]Train Epoch: 0 [5/45 (9%)] Loss: 0.053487: : 4it [00:07,  1.87s/it]Train Epoch: 0 [5/45 (9%)] Loss: 0.053487: : 5it [00:07,  1.49s/it]Train Epoch: 0 [6/45 (11%)] Loss: 0.056632: : 5it [00:08,  1.66s/it]Train Epoch: 0 [6/45 (11%)] Loss: 0.056632: : 6it [00:08,  1.39s/it]Train Epoch: 0 [7/45 (13%)] Loss: 0.058187: : 6it [00:09,  1.53s/it]Train Epoch: 0 [7/45 (13%)] Loss: 0.058187: : 7it [00:09,  1.31s/it]Train Epoch: 0 [8/45 (16%)] Loss: 0.052600: : 7it [00:10,  1.43s/it]Train Epoch: 0 [8/45 (16%)] Loss: 0.052600: : 8it [00:10,  1.25s/it]Train Epoch: 0 [9/45 (18%)] Loss: 0.056490: : 8it [00:10,  1.36s/it]Train Epoch: 0 [9/45 (18%)] Loss: 0.056490: : 9it [00:10,  1.21s/it]Train Epoch: 0 [10/45 (20%)] Loss: 0.053132: : 9it [00:11,  1.31s/it]Train Epoch: 0 [10/45 (20%)] Loss: 0.053132: : 10it [00:11,  1.18s/it]Train Epoch: 0 [11/45 (22%)] Loss: 0.054095: : 10it [00:12,  1.26s/it]Train Epoch: 0 [11/45 (22%)] Loss: 0.054095: : 11it [00:12,  1.15s/it]Train Epoch: 0 [12/45 (24%)] Loss: 0.050765: : 11it [00:13,  1.23s/it]Train Epoch: 0 [12/45 (24%)] Loss: 0.050765: : 12it [00:13,  1.12s/it]Train Epoch: 0 [13/45 (27%)] Loss: 0.052938: : 12it [00:14,  1.19s/it]Train Epoch: 0 [13/45 (27%)] Loss: 0.052938: : 13it [00:14,  1.10s/it]Train Epoch: 0 [14/45 (29%)] Loss: 0.057114: : 13it [00:15,  1.17s/it]Train Epoch: 0 [14/45 (29%)] Loss: 0.057114: : 14it [00:15,  1.09s/it]Train Epoch: 0 [15/45 (31%)] Loss: 0.053517: : 14it [00:16,  1.15s/it]Train Epoch: 0 [15/45 (31%)] Loss: 0.053517: : 15it [00:16,  1.07s/it]Train Epoch: 0 [16/45 (33%)] Loss: 0.051397: : 15it [00:16,  1.13s/it]Train Epoch: 0 [16/45 (33%)] Loss: 0.051397: : 16it [00:16,  1.06s/it]Train Epoch: 0 [17/45 (36%)] Loss: 0.051981: : 16it [00:17,  1.11s/it]Train Epoch: 0 [17/45 (36%)] Loss: 0.051981: : 17it [00:17,  1.04s/it]Train Epoch: 0 [18/45 (38%)] Loss: 0.057239: : 17it [00:18,  1.10s/it]Train Epoch: 0 [18/45 (38%)] Loss: 0.057239: : 18it [00:18,  1.03s/it]Train Epoch: 0 [19/45 (40%)] Loss: 0.049948: : 18it [00:19,  1.08s/it]Train Epoch: 0 [19/45 (40%)] Loss: 0.049948: : 19it [00:19,  1.03s/it]Train Epoch: 0 [20/45 (42%)] Loss: 0.052713: : 19it [00:20,  1.07s/it]Train Epoch: 0 [20/45 (42%)] Loss: 0.052713: : 20it [00:20,  1.02s/it]Train Epoch: 0 [21/45 (44%)] Loss: 0.055641: : 20it [00:21,  1.06s/it]Train Epoch: 0 [21/45 (44%)] Loss: 0.055641: : 21it [00:21,  1.01s/it]Train Epoch: 0 [22/45 (47%)] Loss: 0.048907: : 21it [00:22,  1.05s/it]Train Epoch: 0 [22/45 (47%)] Loss: 0.048907: : 22it [00:22,  1.00s/it]Train Epoch: 0 [23/45 (49%)] Loss: 0.054264: : 22it [00:22,  1.04s/it]Train Epoch: 0 [23/45 (49%)] Loss: 0.054264: : 23it [00:22,  1.00it/s]Train Epoch: 0 [24/45 (51%)] Loss: 0.055012: : 23it [00:23,  1.03s/it]Train Epoch: 0 [24/45 (51%)] Loss: 0.055012: : 24it [00:23,  1.01it/s]Train Epoch: 0 [25/45 (53%)] Loss: 0.051973: : 24it [00:24,  1.03s/it]Train Epoch: 0 [25/45 (53%)] Loss: 0.051973: : 25it [00:24,  1.02it/s]Train Epoch: 0 [26/45 (56%)] Loss: 0.052696: : 25it [00:25,  1.02s/it]Train Epoch: 0 [26/45 (56%)] Loss: 0.052696: : 26it [00:25,  1.02it/s]Train Epoch: 0 [27/45 (58%)] Loss: 0.057895: : 26it [00:26,  1.01s/it]Train Epoch: 0 [27/45 (58%)] Loss: 0.057895: : 27it [00:26,  1.03it/s]Train Epoch: 0 [28/45 (60%)] Loss: 0.050401: : 27it [00:27,  1.00s/it]Train Epoch: 0 [28/45 (60%)] Loss: 0.050401: : 28it [00:27,  1.03it/s]Train Epoch: 0 [29/45 (62%)] Loss: 0.057691: : 28it [00:27,  1.00it/s]Train Epoch: 0 [29/45 (62%)] Loss: 0.057691: : 29it [00:27,  1.04it/s]Train Epoch: 0 [30/45 (64%)] Loss: 0.056370: : 29it [00:28,  1.01it/s]Train Epoch: 0 [30/45 (64%)] Loss: 0.056370: : 30it [00:28,  1.04it/s]Train Epoch: 0 [31/45 (67%)] Loss: 0.056204: : 30it [00:29,  1.01it/s]Train Epoch: 0 [31/45 (67%)] Loss: 0.056204: : 31it [00:29,  1.04it/s]Train Epoch: 0 [32/45 (69%)] Loss: 0.054601: : 31it [00:30,  1.02it/s]Train Epoch: 0 [32/45 (69%)] Loss: 0.054601: : 32it [00:30,  1.05it/s]Train Epoch: 0 [33/45 (71%)] Loss: 0.055546: : 32it [00:31,  1.02it/s]Train Epoch: 0 [33/45 (71%)] Loss: 0.055546: : 33it [00:31,  1.05it/s]Train Epoch: 0 [34/45 (73%)] Loss: 0.052531: : 33it [00:32,  1.03it/s]Train Epoch: 0 [34/45 (73%)] Loss: 0.052531: : 34it [00:32,  1.06it/s]Train Epoch: 0 [35/45 (76%)] Loss: 0.057752: : 34it [00:32,  1.03it/s]Train Epoch: 0 [35/45 (76%)] Loss: 0.057752: : 35it [00:32,  1.06it/s]Train Epoch: 0 [36/45 (78%)] Loss: 0.054560: : 35it [00:33,  1.03it/s]Train Epoch: 0 [36/45 (78%)] Loss: 0.054560: : 36it [00:33,  1.06it/s]Train Epoch: 0 [37/45 (80%)] Loss: 0.057782: : 36it [00:34,  1.04it/s]Train Epoch: 0 [37/45 (80%)] Loss: 0.057782: : 37it [00:34,  1.07it/s]Train Epoch: 0 [38/45 (82%)] Loss: 0.054586: : 37it [00:35,  1.04it/s]Train Epoch: 0 [38/45 (82%)] Loss: 0.054586: : 38it [00:35,  1.07it/s]Train Epoch: 0 [39/45 (84%)] Loss: 0.054766: : 38it [00:36,  1.05it/s]Train Epoch: 0 [39/45 (84%)] Loss: 0.054766: : 39it [00:36,  1.07it/s]Train Epoch: 0 [40/45 (87%)] Loss: 0.053419: : 39it [00:37,  1.05it/s]Train Epoch: 0 [40/45 (87%)] Loss: 0.053419: : 40it [00:37,  1.08it/s]Train Epoch: 0 [41/45 (89%)] Loss: 0.052994: : 40it [00:38,  1.05it/s]Train Epoch: 0 [41/45 (89%)] Loss: 0.052994: : 41it [00:38,  1.08it/s]Train Epoch: 0 [42/45 (91%)] Loss: 0.055938: : 41it [00:38,  1.06it/s]Train Epoch: 0 [42/45 (91%)] Loss: 0.055938: : 42it [00:38,  1.08it/s]Train Epoch: 0 [43/45 (93%)] Loss: 0.056717: : 42it [00:39,  1.06it/s]Train Epoch: 0 [43/45 (93%)] Loss: 0.056717: : 43it [00:39,  1.08it/s]Train Epoch: 0 [44/45 (96%)] Loss: 0.054482: : 43it [00:40,  1.06it/s]Train Epoch: 0 [44/45 (96%)] Loss: 0.054482: : 44it [00:40,  1.09it/s]Train Epoch: 0 [45/45 (98%)] Loss: 0.055287: : 44it [00:41,  1.06it/s]Train Epoch: 0 [45/45 (98%)] Loss: 0.055287: : 45it [00:41,  1.09it/s]
**Evaluating...**
  0%|          | 0/47 [00:00<?, ?it/s]  2%|▏         | 1/47 [00:00<00:37,  1.21it/s]  4%|▍         | 2/47 [00:01<00:37,  1.20it/s]  6%|▋         | 3/47 [00:02<00:36,  1.19it/s]  9%|▊         | 4/47 [00:03<00:35,  1.20it/s] 11%|█         | 5/47 [00:04<00:35,  1.18it/s] 13%|█▎        | 6/47 [00:04<00:34,  1.20it/s] 15%|█▍        | 7/47 [00:05<00:33,  1.20it/s] 17%|█▋        | 8/47 [00:06<00:32,  1.19it/s] 19%|█▉        | 9/47 [00:07<00:31,  1.19it/s] 21%|██▏       | 10/47 [00:08<00:31,  1.19it/s] 23%|██▎       | 11/47 [00:09<00:30,  1.19it/s] 26%|██▌       | 12/47 [00:10<00:29,  1.19it/s] 28%|██▊       | 13/47 [00:10<00:28,  1.19it/s] 30%|██▉       | 14/47 [00:11<00:27,  1.19it/s] 32%|███▏      | 15/47 [00:12<00:26,  1.19it/s] 34%|███▍      | 16/47 [00:13<00:26,  1.18it/s] 36%|███▌      | 17/47 [00:14<00:25,  1.18it/s] 38%|███▊      | 18/47 [00:15<00:24,  1.18it/s] 40%|████      | 19/47 [00:16<00:23,  1.18it/s] 43%|████▎     | 20/47 [00:16<00:22,  1.18it/s] 45%|████▍     | 21/47 [00:17<00:22,  1.18it/s] 47%|████▋     | 22/47 [00:18<00:21,  1.18it/s] 49%|████▉     | 23/47 [00:19<00:20,  1.18it/s] 51%|█████     | 24/47 [00:20<00:19,  1.18it/s] 53%|█████▎    | 25/47 [00:21<00:18,  1.18it/s] 55%|█████▌    | 26/47 [00:21<00:17,  1.18it/s] 57%|█████▋    | 27/47 [00:22<00:16,  1.18it/s] 60%|█████▉    | 28/47 [00:23<00:16,  1.18it/s] 62%|██████▏   | 29/47 [00:24<00:15,  1.18it/s] 64%|██████▍   | 30/47 [00:25<00:14,  1.18it/s] 66%|██████▌   | 31/47 [00:26<00:13,  1.18it/s] 68%|██████▊   | 32/47 [00:27<00:12,  1.18it/s] 70%|███████   | 33/47 [00:27<00:11,  1.18it/s] 72%|███████▏  | 34/47 [00:28<00:11,  1.18it/s] 74%|███████▍  | 35/47 [00:29<00:10,  1.18it/s] 77%|███████▋  | 36/47 [00:30<00:09,  1.18it/s] 79%|███████▊  | 37/47 [00:31<00:08,  1.18it/s] 81%|████████  | 38/47 [00:32<00:07,  1.18it/s] 83%|████████▎ | 39/47 [00:33<00:06,  1.18it/s] 85%|████████▌ | 40/47 [00:33<00:05,  1.18it/s] 87%|████████▋ | 41/47 [00:34<00:05,  1.18it/s] 89%|████████▉ | 42/47 [00:35<00:04,  1.18it/s] 91%|█████████▏| 43/47 [00:36<00:03,  1.18it/s] 94%|█████████▎| 44/47 [00:37<00:02,  1.18it/s] 96%|█████████▌| 45/47 [00:38<00:01,  1.18it/s] 98%|█████████▊| 46/47 [00:39<00:00,  1.18it/s]100%|██████████| 47/47 [00:39<00:00,  1.19it/s]
R@1 : 40.935
R@2 : 53.174
R@4 : 66.256
R@8 : 78.460
R@16 : 87.171
R@32 : 93.298
Corruption : gaussian_noise, Severity : 1
Traceback (most recent call last):
  File "C:/Users/Juhyeon/Desktop/repository/Proxy-Anchor-CVPR2020/code/train.py", line 363, in <module>
    Recalls_c = utils.evaluate_cos(model, dl_ev_c)
  File "C:\Users\Juhyeon\Desktop\repository\Proxy-Anchor-CVPR2020\code\utils.py", line 67, in evaluate_cos
    nb_classes = dataloader.dataset.nb_classes()
  File "C:\Users\Juhyeon\Desktop\repository\Proxy-Anchor-CVPR2020\code\dataset\base.py", line 18, in nb_classes
    assert set(self.ys) == set(self.classes)
AssertionError
